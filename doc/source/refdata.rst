.. _refdata:

Reference structures database
=============================

BOPcat requires a list of structures each is an ``ase.Atoms`` object.
These are extracted from a generic database which takes in general identifiers
depending on the data type. Currently, only ``dft`` data are handled in
but can be extended to include data from experiments or
other calculation schemes. The ``Atoms`` also contain the calculation
parameters, details of the crystal structure and various properties that are
required for fitting. The data are extracted from the database once and are written in
a readable text format for future use. 

.. _`General DFT identifiers`: 

    **General DFT identifiers**

    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |key                        |val                        |description                        |val                        |description                  |
    +===========================+===========================+===================================+===========================+=============================+
    |code                       |0                          |abinit                             |100                        |crystal                      |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |1                          |castep                             |101                        |fhi-aims                     |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |2                          |dacapo                             |102                        |gaussian                     |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |3                          |gpaw                               |103                        |octopus                      |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |4                          |qbox                               |104                        |siesta                       |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |5                          |quantum-espresso                   |105                        |turbomole                    |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |6                          |sphinx                             |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |7                          |vasp                               |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |200                        |exciting                           |999                        |unknown                      |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |201                        |fleur                              |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |202                        |wien2k                             |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |basis_set                  |0                          |plane waves                        |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |1                          |atomic orbitals                    |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |2                          |gaussians                          |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |9                          |unknown                            |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |xc_functional              |0                          |hf ab-initio                       |100                        |pw lda                       |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |1                          |sx ab-initio                       |101                        |pz lda                       |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |                           |                                   |102                        |vwn lda                      |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |200                        |blyp gga                           |300                        |tpss meta                    |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |201                        |pbe gga                            |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |202                        |pw91 gga                           |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |203                        |rpbe gga                           |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |204                        |pbesol gga                         |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |205                        |wc gga                             |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |206                        |lm gga                             |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |400                        |b3lyp hybrid                       |999                        |unknown                      |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |401                        |hse hybrid                         |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |402                        |pbe0 hybrid                        |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |403                        |tpssh hybrid                       |                           |                             |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |pseudopotential            |0                          |all electron                       |10                         |martins-troullier nc         |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |                           |                                   |11                         |bachelet-hamman-schlueter nc |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |                           |                                   |12                         |morrison-bylander-kleinman nc|
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |20                         |vanderbilt us                      |30                         |kresse-joubert paw           |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+
    |                           |21                         |rappe-rabe-kaxiras-joannopoulos us |99                         |unknown                      |
    +---------------------------+---------------------------+-----------------------------------+---------------------------+-----------------------------+

For ``dft`` reference data, four general identifiers namely ``code``, ``xc_functional``,
``pseudopotential`` and ``basis set`` are passed to the database. Each of these
identifiers have a corresponding integer value for the purpose of
classification (see `General DFT identifiers`_). The DFT codes are arranged
in the following manner. The first set use mainly plawe wave basis while those
from 100-199 use local atomic
orbital basis while the third are all-electron DFT codes. The classification for the 
other identifiers are are also evident from `General DFT identifiers`_. The database 
returns a list of ``Atoms`` that meet these criteria for the general identifiers.
The database is expected to also supply supplementary identifiers listed in `Supplementary DFT identifiers`_
in ``Atoms.info``. The information are used in BOPcat to filter the data. To extend
the supplementary identifiers, one simply add keywords in :func:`variables.data_keys`

.. _`Supplementary DFT identifiers`: 

    **Supplementary DFT identifiers**

    +---------------------------+---------------------------+-----------------------------------+
    |key                        |val                        |description                        |
    +===========================+===========================+===================================+
    |hubbard                    |0.0                        |U value                            |
    +---------------------------+---------------------------+-----------------------------------+
    |lr_correction              |0/1                        |long-range correction              |
    +---------------------------+---------------------------+-----------------------------------+
    |relativistic               |0/1                        |relativistic                       |
    +---------------------------+---------------------------+-----------------------------------+
    |valency                    |3pd7s1                     |valence states                     |
    +---------------------------+---------------------------+-----------------------------------+
    |nlc_correction             |0/1                        |non-linear core correction         |
    +---------------------------+---------------------------+-----------------------------------+
    |encut                      |0.0                        |cut-off energy                     |
    +---------------------------+---------------------------+-----------------------------------+
    |deltak                     |0.0                        |k-points(1/Angstroem)              |
    +---------------------------+---------------------------+-----------------------------------+
    |encut_ok                   |0/1                        |converged wrt encut                |
    +---------------------------+---------------------------+-----------------------------------+
    |deltak_ok                  |0/1                        |converged wrt deltak               |
    +---------------------------+---------------------------+-----------------------------------+
    |author                     |Pedro5                     |author ID                          |
    +---------------------------+---------------------------+-----------------------------------+

The database should also return identifiers for the structure. These
include the ``stoichiometry``, ``space group number``, ``sytem type``,
``calculation type`` and ``calculation order``. The ``system_type`` can refer
to any of the following: ``bulk``, ``cluster``, ``defect``, ``surface`` or ``interface``.
An integer value is also assigned to the system types, i.e. 

``0-bulk 1-cluster 2-defect 3-surface 4-interface`` 

.. todo:: Extend system types.

The nature of ``calculation_type`` and ``calculation_order`` vary depending on ``system_type``. These
are listed in `Structure identifiers`_.

.. _`Structure identifiers`: 

    **Structure identifiers**

    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |calc_type                  |description                        |calc_order                 |description                                                |
    +===========================+===================================+===========================+===========================================================+
    |*bulk*                                                                                                                                                 |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |0                          |relaxation                         |N                          |0-unrelax, 1-relax ion, 2-relax vol, 3-relax all           |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |1                          |volume                             |0.0                        |volume per atom                                            |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |2                          |elastic                            |v.x                        |v-strain(Voigt), x-displacement                            |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |3                          |phonon                             |Iv.x                       |I-atom index, v-strain(Voigt), x-displacement              |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |4                          |transformation                     |Td.x                       |T-transformation type, d.x-deformation factor              |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+
    |99                         |unknown                            |99.99                      |unknown                                                    |
    +---------------------------+-----------------------------------+---------------------------+-----------------------------------------------------------+

.. todo:: Determine identifier for other system types.

Each structure may contain an energy, forces,stresses, eigenvalues and orbital\_character,
vacancy energy and other properties. To extend this to include other properties, one
simply needs to add the key to the :func:`variables.data_keys`.
